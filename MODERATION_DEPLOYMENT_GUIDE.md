# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 2026-01-01
**–í–µ—Ä—Å–∏—è:** 1.0.0
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é ‚úÖ

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π](#–æ–±–∑–æ—Ä-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
3. [–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π](#–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-–º–∏–≥—Ä–∞—Ü–∏–π)
4. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤)
6. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## üéØ –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

#### 1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** ‚úÖ
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±–∑–æ—Ä–æ–≤ (`building_reviews`)
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –±–ª–æ–≥–æ–≤ (`blog_posts`)
- ‚úÖ –û—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (`moderation_queue`)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (`building_edit_history`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (3 —Ñ—É–Ω–∫—Ü–∏–∏)
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (`approve_content`, `reject_content`)

#### 2. **Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** ‚úÖ
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (`ModerationQueue`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–¥–∞–Ω–∏–π
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ö–æ–∂–∏—Ö –æ–±—ä–µ–∫—Ç–∞—Ö

#### 3. **–£—Ç–∏–ª–∏—Ç—ã –∏ —Ö—É–∫–∏** ‚úÖ
- ‚úÖ `lib/duplicateDetection.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ `hooks/useDuplicateCheck.ts` - React hook

---

## üöÄ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!** –ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π:

```bash
# –ß–µ—Ä–µ–∑ Supabase Dashboard
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Database ‚Üí Backups
2. –°–æ–∑–¥–∞–π—Ç–µ snapshot –≤—Ä—É—á–Ω—É—é
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è 011 (notifications) —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã notifications
SELECT table_name
FROM information_schema.tables
WHERE table_schema = 'public'
AND table_name = 'notifications';

-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å: notifications
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞:
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ RLS –ø–æ–ª–∏—Ç–∏–∫

---

## üì¶ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

### –ú–∏–≥—Ä–∞—Ü–∏—è 050: –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `database/migrations/050_complete_moderation_system.sql`

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç:**
- –ú–æ–¥–µ—Ä–∞—Ü–∏—é –æ–±–∑–æ—Ä–æ–≤
- –ú–æ–¥–µ—Ä–∞—Ü–∏—é –±–ª–æ–≥–æ–≤
- –û—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- –ò—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–¥–∞–Ω–∏–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ MCP Supabase:**

```typescript
// –í Claude Code —Å MCP Supabase
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:
mcp__supabase__apply_migration

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- project_id: [–≤–∞—à project ID]
- name: "050_complete_moderation_system"
- query: [—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ 050_complete_moderation_system.sql]
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ Supabase SQL Editor:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `050_complete_moderation_system.sql`
4. –ù–∞–∂–º–∏—Ç–µ "Run"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT * FROM moderation_queue LIMIT 1;
SELECT * FROM building_edit_history LIMIT 1;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'building_reviews'
AND column_name = 'moderation_status';
-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å: moderation_status
```

---

### –ú–∏–≥—Ä–∞—Ü–∏—è 051: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–§–∞–π–ª:** `database/migrations/051_duplicate_detection.sql`

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç:**
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `pg_trgm` –¥–ª—è fuzzy search
- –§—É–Ω–∫—Ü–∏—é `find_nearby_buildings` - –ø–æ–∏—Å–∫ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
- –§—É–Ω–∫—Ü–∏—é `find_similar_buildings_by_name` - –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –§—É–Ω–∫—Ü–∏—é `check_building_duplicates` - –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- –¢—Ä–∏–≥–≥–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–∏ 050, —á–µ—Ä–µ–∑ MCP –∏–ª–∏ SQL Editor.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
SELECT * FROM pg_extension WHERE extname = 'pg_trgm';

-- –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏
SELECT * FROM find_nearby_buildings(55.751244, 37.618423, 100);

-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å –∑–¥–∞–Ω–∏—è –≤ —Ä–∞–¥–∏—É—Å–µ 100–º –æ—Ç –ö—Ä–∞—Å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏
```

---

### –ú–∏–≥—Ä–∞—Ü–∏—è 052: –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `database/migrations/052_moderation_functions.sql`

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç:**
- `approve_content` - –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `reject_content` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `get_moderation_stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –º–∏–≥—Ä–∞—Ü–∏—è–º.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
SELECT * FROM get_moderation_stats();

-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ building, review, blog
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–¥–∞–Ω–∏—è —Å –¥—É–±–ª–∏–∫–∞—Ç–æ–º

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/test-map`
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–¥–∞–Ω–∏—è
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–¥–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–≠–π—Ñ–µ–ª–µ–≤–∞ –±–∞—à–Ω—è")
4. –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ Paris
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ–º –¥—É–±–ª–∏–∫–∞—Ç–µ

### 2. –¢–µ—Å—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∑–¥–∞–Ω–∏—è

**–®–∞–≥–∏:**
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (Guide)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –∑–¥–∞–Ω–∏–µ
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–¥–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å `pending`
4. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä/–∞–¥–º–∏–Ω
5. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/moderation`
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–¥–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –æ—á–µ—Ä–µ–¥–∏
7. –û–¥–æ–±—Ä–∏—Ç–µ –∑–¥–∞–Ω–∏–µ
8. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### 3. –¢–µ—Å—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ–±–∑–æ—Ä–∞

**–®–∞–≥–∏:**
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ Guide
2. –°–æ–∑–¥–∞–π—Ç–µ –æ–±–∑–æ—Ä –Ω–∞ –ª—é–±–æ–µ –∑–¥–∞–Ω–∏–µ
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –û–±–∑–æ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å `moderation_status = 'pending'`
4. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä
5. –û—Ç–∫—Ä–æ–π—Ç–µ –æ—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
6. –û–¥–æ–±—Ä–∏—Ç–µ –æ–±–∑–æ—Ä
7. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –æ–±–∑–æ—Ä –≤–∏–¥–µ–Ω –≤—Å–µ–º

### 4. –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –æ—Ç –∏–º–µ–Ω–∏ Guide
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–¥–∞–Ω–∏–µ/–æ–±–∑–æ—Ä
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—è–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "üü° –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"
4. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –æ–¥–æ–±—Ä—è–µ—Ç
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Guide –ø–æ–ª—É—á–∞–µ—Ç "‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ!"
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫ –≤ header - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ

### 5. –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**

```sql
-- –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–¥–∞–Ω–∏–µ
INSERT INTO buildings (name, city, country, latitude, longitude, created_by, moderation_status)
VALUES ('–¢–µ—Å—Ç–æ–≤–æ–µ –∑–¥–∞–Ω–∏–µ', '–ú–æ—Å–∫–≤–∞', '–†–æ—Å—Å–∏—è', 55.751244, 37.618423,
  (SELECT id FROM profiles LIMIT 1), 'approved');
```

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–¥–∞–Ω–∏—è
2. –í–≤–µ–¥–∏—Ç–µ "–¢–µ—Å—Ç–æ–≤–æ–µ –∑–¥–∞" –≤ –ø–æ–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è
3. –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ "–ú–æ—Å–∫–≤–∞"
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
5. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É —Ä—è–¥–æ–º —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (55.751244, 37.618423)
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º

---

## üë®‚Äçüíº –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤

### –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ä–æ–ª–∏ Moderator

```sql
-- –ù–∞–π–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT id, email, username FROM profiles WHERE email = 'moderator@example.com';

-- –ü—Ä–∏—Å–≤–æ–π—Ç–µ —Ä–æ–ª—å
UPDATE profiles
SET role = 'moderator'
WHERE id = '[UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞
SELECT id, email, role FROM profiles WHERE role IN ('moderator', 'admin');
```

### –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ä–æ–ª–∏ Expert

```sql
-- –î–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
UPDATE profiles
SET role = 'expert'
WHERE id = '[UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]';
```

### –ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

```sql
-- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ–±—è –∫–∞–∫ –∞–¥–º–∏–Ω–∞
UPDATE profiles
SET role = 'admin'
WHERE email = 'your-email@example.com';
```

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:** –û—à–∏–±–∫–∞ "relation already exists" –∏–ª–∏ "function already exists"

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';
SELECT routine_name FROM information_schema.routines WHERE routine_schema = 'public';

-- –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞/—Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ –µ—Å—Ç—å, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ –µ—ë —Å–æ–∑–¥–∞–Ω–∏–µ
-- –ò–ª–∏ —É–¥–∞–ª–∏—Ç–µ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ (–û–°–¢–û–†–û–ñ–ù–û!)
```

### –ü—Ä–æ–±–ª–µ–º–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã
SELECT trigger_name, event_manipulation, event_object_table
FROM information_schema.triggers
WHERE trigger_schema = 'public'
AND event_object_table IN ('buildings', 'building_reviews', 'blog_posts');

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
-- trigger_notify_moderation_status (buildings)
-- trigger_notify_review_moderation (building_reviews)
-- trigger_notify_blog_moderation (blog_posts)
```

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ 050.

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ pg_trgm
SELECT * FROM pg_extension WHERE extname = 'pg_trgm';

-- –ï—Å–ª–∏ –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ
CREATE EXTENSION IF NOT EXISTS pg_trgm;

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã
SELECT indexname FROM pg_indexes
WHERE tablename = 'buildings'
AND indexname LIKE '%trgm%';
```

### –ü—Ä–æ–±–ª–µ–º–∞: RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø

**–°–∏–º–ø—Ç–æ–º—ã:** –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –Ω–µ –≤–∏–¥–∏—Ç –æ—á–µ—Ä–µ–¥—å –∏–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏
SELECT schemaname, tablename, policyname
FROM pg_policies
WHERE tablename IN ('moderation_queue', 'building_reviews', 'blog_posts');

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏
SELECT is_moderator_or_admin();
-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å true –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤

-- –ï—Å–ª–∏ false, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å
SELECT role FROM profiles WHERE id = auth.uid();
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```sql
-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–µ—Ä–µ–¥–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
SELECT
  content_type,
  status,
  COUNT(*) as count
FROM moderation_queue
GROUP BY content_type, status
ORDER BY content_type, status;

-- –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤
SELECT
  p.email,
  COUNT(*) as unread_notifications
FROM notifications n
JOIN profiles p ON n.user_id = p.id
WHERE n.is_read = false
AND p.role IN ('moderator', 'admin')
GROUP BY p.email;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
SELECT
  DATE(created_at) as date,
  content_type,
  COUNT(*) as created_count
FROM moderation_queue
WHERE created_at > NOW() - INTERVAL '30 days'
GROUP BY DATE(created_at), content_type
ORDER BY date DESC;
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

- [ ] –í—Å–µ 3 –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –ú–∏–Ω–∏–º—É–º 1 –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [ ] –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Supabase Dashboard ‚Üí Logs
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ `MODERATION_SYSTEM_IMPLEMENTATION.md`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TROUBLESHOOTING.md` –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

---

**–°–æ–∑–¥–∞–Ω–æ:** 2026-01-01
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-01
